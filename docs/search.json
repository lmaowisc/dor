[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Analysis of duration of response in oncology studies",
    "section": "",
    "text": "This R-code implements the analysis of duration-of-response data described in Mao et al. (2024) for oncology studies .\n\nBackground\nDuration-of-response (DOR) is often utilized to assess efficacy of oncology therapies. While valid procedures are available for estimating the mean (Huang et al. 2018), it is unclear how to estimate the distribution of DOR, which provides a fuller picture of patient experience. Using simple Kaplan–Meier estimates based on the responders can result in distorted conclusions due to the existence of non-responders (whose DOR is zero).\n\n\nNotation and Methodology\n\nFull and Observed Data\nFor a responder, let \\(T_1\\) denote the time to response. Let \\(T_2\\) denote the time to disease progression or death. If a patient experiences progression/death first, then \\(T_1=\\infty\\). The DOR can be defined as \\([T_2-T_1]_+\\), where \\(x_+=xI(x&gt;0).\\) Thus, DOR is \\(T_2-T_1\\) for responders, i.e., those with \\(T_1&lt;\\infty\\), and 0 for nonresponders. For notational convenience, set \\(T_1=T_2\\) for nonresponders.\nDue to limited follow-up, the entire distribution of DOR is not identifiable. Instead, we define the restricted DOR within a time window as \\(D=T_2\\wedge \\tau -T_1\\wedge \\tau\\), where \\(\\tau\\) is a pre-specified restriction time. Our goal is to estimate the survival function of \\(D:\\) \\[S_D(t)=P(D&gt;t), \\,\\,\\,\\,\\, t\\in [0, \\tau].\\]\nLet \\(C\\) denote the censoring time independent of \\((T_1, T_2)\\) and satisfying \\(P(C\\geq \\tau)&gt;0\\). Then we observe \\((X_1,\\Delta_1,X_2,\\Delta_2)\\), where \\(X_1=\\min(T_1\\wedge\\tau, C)\\), \\(\\Delta_1=I(T_1\\wedge\\tau\\leq C)\\), \\(X_2=\\min(T_2\\wedge\\tau,C)\\), and \\(\\Delta_2=I(T_2\\wedge\\tau\\leq C).\\) Write \\(\\tilde D=X_2 - X_1\\). Here both \\(T_1\\) and \\(T_2\\) are subject to the same censoring time \\(C\\). The observed data consist of \\(n\\) independent and identically distributed (i.i.d.) copies of \\((X_1,\\Delta_1,X_2,\\Delta_2)\\): \\(\\{(X_{1i},\\Delta_{1i},X_{2i},\\Delta_{2i}): i=1,\\ldots,n\\}.\\) Write \\(\\tilde D_i=X_{2i}- X_{1i}\\).\n\n\nEstimation and Inference\nA simple estimator of \\(S_D(t)\\) is the inverse probability censoring weighted (IPCW) estimator: \\[\n\\hat S_D(t)=n^{-1}\\sum_{i=1}^n  \\frac{\\Delta_{2i}}{\\hat{G}_C(X_{2i})} I(\\tilde D_i&gt; t),\n\\] where \\(\\hat{G}_C(t)\\) is the Kaplan–Meier estimator of \\(G_C(t)=P(C&gt;t)\\) based on \\(\\{(X_{2i}, 1-\\Delta_{2i}), i=1, \\cdots, n\\}\\). To see \\(\\hat S_D(t)\\) as a valid estimator, note that \\(\\Delta_{2}=1\\) implies that \\(X_2=T_2\\wedge\\tau\\), \\(X_1=T_1\\wedge\\tau\\) and thus that \\(\\tilde D = D\\). Hence, \\(E\\left\\{\\Delta_2I(\\tilde D&gt;t)/G_C(X_2)\\right\\}= E\\left\\{\\Delta_2I(D&gt;t)/G_C(T_2\\wedge\\tau)\\right\\} =E\\left[E\\left\\{\\Delta_2I(D&gt;t)/G_C(T_2\\wedge\\tau)\\mid T_1, T_2\\right\\}\\right] =E\\{I(D&gt;t)\\}=S_D(t)\\), where the second equality follows by the independence of \\(C\\) and \\((T_1, T_2)\\). Moreover, we can show that \\(\\hat S_D(t)\\) converges weakly to a Gaussian process with an easily estimable variance function.\nThe median DOR can thus be estimated by \\(\\inf\\{t: \\hat S_D(t)\\geq 0.5\\}\\), whose variance can be estimated by the perturbing the influence functions of \\(\\hat S_D(t)\\) using standard normal distributed random noises.\n\n\n\nUsage and Example\n\nR-program\nTo use the program, download DORfunctions.R from repo https://github.com/lmaowisc/dor. The R-file contains all functions needed to perform the analysis. We also need the standard survival package.\n\nlibrary(survival)\nsource(\"DORfunctions.R\")\n\nThe main function is dorfit(x1, delta1, x2, delta2, tau, med_inf = FALSE).\nInput\n\nx1 time to earliest of response, outcome event, or censoring\ndelta1 indicator of response\nx2 time to earlier of outcome event and censoring\ndelta2 indicator of outcome event\ntau restriction time\nmed_inf whether to make inference on the median DOR\n\nOutput\n\nt1 vector of times (t)\nsurv1 IPCW estimates of survival function \\(P(D &gt; t)\\)\nse1 pointwise standard error of \\(P(D &gt; t)\\)\nmed median estimate of DOR\nmed_se, med_lo, med_hi these are standard error, lower and upper limits of the 95% confidence interval of the median, respectively, if med_inf = TRUE; all NULL if med_inf = FALSE\n\n\n\nA simulated example\nLet’s simulate a data set of size \\(n=200\\).\n\n# set seed for random number generation\nset.seed(2023)\n\n## simulate data\nn &lt;- 200\n# set restriction time\ntau &lt;- 1.25\n\n# full data\nt1 &lt;- pmin(rexp(n), runif(n, 0, 0.75)) # response time\nt2 &lt;- rexp(n)*1.5 # outcome event time\nt1[t1&gt;t2] &lt;- t2[t1&gt;t2] # set t1 = t2 for non-responders\nc &lt;- runif(n, 0, 1.5) # censoring time\n\n# observed (censored) data\nx1 &lt;- pmin(t1, c)\ndelta1 &lt;- 1*(t1&lt;c)\nx2 &lt;- pmin(t2, c)\ndelta2 &lt;- 1*(t2&lt;c)\n\nSo the observed data consist of x1, delta1, x2, and delta2. Under restriction time tau\\(= 1.25\\). We analyze the DOR distribution using the main function dorfit(), with inference on the median.\n\nfitLM &lt;- dorfit(x1, delta1, x2, delta2, tau, med_inf = TRUE)\n\nLet’s plot the estimated \\(S_D(t)\\) with 95% pointwise confidence limits.\n\nza &lt;- qnorm(0.975)\n## marginal survival function P(D &gt; t)\nt &lt;- fitLM$t1 # times\nSt &lt;- fitLM$surv1 # P(D &gt; t)\nse &lt;- fitLM$se1 # se of P(D &gt; t)\n\n# set up the figure\nplot(c(0, 1.2), c(0, 1), type=\"n\",xlab=\"t\",ylab=expression(S[D](t)))\n\n# plot the marginal curve P(D &gt; t)\nlines(stepfun(t, c(1,St)),lwd=2, do.points = FALSE) # marginal\nlines(stepfun(t, c(1,St + za * se)),lty = 3, do.points = FALSE) # upper 95% CI \nlines(stepfun(t, c(1,St - za * se)),lty = 3, do.points = FALSE) # lower 95% CI \n\n\n\n\nWe can see that the median is close to 0.6. The precise number and confidence interval (CI) can be obtained from obj.\n\n######## get the median ####\nmed &lt;- fitLM$med\nmed\n# [1] 0.551916\n\nmed_lo &lt;- fitLM$med_lo\nmed_hi &lt;- fitLM$med_hi\nmed_lo\n# [1] 0.4018724\nmed_hi\n# [1] 0.7019595\n\nSo the estimated median DOR (95% CI) is 0.552 (0.402, 0.702).\n\n\n\n\n\n\nReferences\n\nHuang, Bo, Lu Tian, Enayet Talukder, Mace Rothenberg, Dae Hyun Kim, and Lee-Jen Wei. 2018. “Evaluating Treatment Effect Based on Duration of Response for a Comparative Oncology Study.” JAMA Oncology 4 (6): 874. https://doi.org/10.1001/jamaoncol.2018.0275.\n\n\nMao, Lu, Lu Tian, Bo Huang, Paul G. Richardson, Mace Rothenberg, Dae Hyun Kim, and Lee-Jen Wei. 2024. “Analysis of Duration-of-Response Data for Oncology Studies.”"
  }
]